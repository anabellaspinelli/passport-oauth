<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>Typeform OAuth</title>
  <style>
    body {
      font-family: arial;
      margin: 0;
    }

    nav {
      background: #ff5353;
      padding: 20px 10px;
    }

    nav ul {
      max-width: 960px;
      margin: 0 auto;
      padding: 0;
    }

    nav li {
      list-style-type: none;
      display: inline-block;
      margin: 0 10px 0 0;
    }

    nav a {
      color: #fff;
      font-size: 18px;
      background: rgba(255, 255, 255, 0.2);
      text-decoration: none;
      padding: 10px;
      display: block;
    }

    main,
    header {
      max-width: 960px;
      padding: 0 10px;
      color: #333;
      margin: auto;
    }

    .token {
      color: #ff5353;
      font-weight: bold;
      font-family: monospace;
      font-size: 18px;
    }

    #buttons {
      display: inline-block;
    }

    button {
      border-radius: 3px;
      padding: 5px;
      margin: 0 5px 0 0;
      color: #fff;
      font-size: 17px;
      background: #ff7575;
      text-decoration: none;
      padding: 5px;
      border: none;
      min-width: 140px;
    }

    button:nth-child(2) {
      background: #55d3ba;
    }

    button:hover {
      cursor: pointer;
    }

    .selected-scope {
      border: 2px solid #55d3ba;
      margin: 0 2px;
      padding: 5px;
      border-radius: 3px;
      display: inline-block;
    }

    #status {
      border: 2px solid #9be3d4;
      margin: 0 2px;
      padding: 5px;
      border-radius: 3px;
      display: none;
    }

    #response {
      font-family: monospace;
      padding: 10px;
      border-radius: 3px;
      display: inline-block;
    }

    pre {
      margin: 0;
    }

    #response-pane {
      background-color: #eef7f5;
      min-height: 300px;
      margin-top: 30px;
    }

    .button-group {
      display: inline-block;
      margin: 0 0 10px 0;
    }

    #dashboard {
      margin: 40px 0 0 0;
    }
  </style>
</head>

<body>
  <nav>
    <ul>
      <% if (user) { %>
        <li>
          <a href="/auth/logout">Log out</a>
        </li>
        <%} else { %>
          <li>
            <a href="/auth/login">Login</a>
          </li>
          <% } %>
    </ul>
  </nav>
  <header>
    <h1>You are now logged in with Typeform
    </h1>
  </header>
  <main>
    <section class="info">
      <p>This is your access token:</p>
      <p class="token">
        <%= user.access_token %>
      </p>
      <p>Your selected scopes in this session are:</p>

      <%if (typeof selectedScopes !== 'string') { %>
        <% selectedScopes.forEach(function(scope) { %>
          <span class="selected-scope">
            <%= scope %>
          </span>
          <% }); %>
            <% } else {%>
              <span class="selected-scope">
                <%= selectedScopes %>
              </span>
              <% } %>


    </section>
    <div id="dashboard">
      <h2>Now try them out!</h2>
      <section id="buttons">
        <% Object.keys(typeformScopes).forEach(function(scopeName) { %>
          <div class="button-group">
            <% typeformScopes[scopeName].forEach(function(scopeRight) { %>
              <button class="<%= scopeName %><% scopeRight.charAt(0).toUpperCase() %>" value="<%= scopeRight === 'read' ? 'GET' : 'POST' %>">
                <%= scopeRight === 'read' ? 'GET' : 'POST' %>
                  <%= scopeRight === 'write' ? scopeName.substring(scopeName.length - 1, 0) : scopeName %>!</button>
              <% }); %>
          </div>
          <% }); %>
      </section>
      <section id="response-pane">
        <pre>
          <h3 id="status"></h3>
          <code id="response">
          </code>
        </pre>
      </section>
    </div>


  </main>
</body>
<script type="application/javascript" src="/js/dashboard.js"></script>

</html>